function isEven(a){return a===parseFloat(a)?!(a%2):void 0}var hasClass=function(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")},addClass=function(a,b){hasClass(a,b)||(a.className+=" "+b)},removeClass=function(a,b){var c=" "+a.className.replace(/[\t\r\n]/g," ")+" ";if(hasClass(a,b)){for(;c.indexOf(" "+b+" ")>=0;)c=c.replace(" "+b+" "," ");a.className=c.replace(/^\s+|\s+$/g,"")}};!function(a){this.config={sensitivity:130},this.attach=function(b,c){var d=document.getElementById(b),e={x:0};d.onmousedown=function(b){a.swipe.start(d,e,b)},d.ontouchstart=function(b){a.swipe.start(d,e,b)},d.onmouseup=function(b){a.swipe.end(d,e,b,c)},d.ontouchend=function(b){a.swipe.end(d,e,b,c)},d.ontouchcancel=function(b){a.swipe.end(d,e,b,c)}},this.start=function(a,b,c){b.x="undefined"!=typeof c.clientX?c.clientX:c.targetTouches[0].pageX},this.end=function(b,c,d,e){var f=0;f="undefined"!=typeof d.clientX?d.clientX:d.changedTouches[0].pageX;var g=c.x-f,h=a.swipe.config.sensitivity,i=-1*a.swipe.config.sensitivity,j=0;g>=h&&(j=1),i>=g&&(j=2),0!==j&&e(j)},a.swipe=this}(window),function(a){var b={viewport:document.getElementById("viewport"),reader:document.getElementById("reader"),title:document.getElementById("title"),brightness:document.getElementById("brightness-toggle"),brightnessOverlay:document.getElementById("brightness-overlay"),brightnessBall:document.getElementById("slider-ball"),brightnessContent:document.getElementById("brightness-content"),beautifyLevel:document.getElementById("beautify-level"),dragDropOverlay:document.getElementById("drag-drop-overlay"),fileSelect:document.getElementById("file-select")},c={width:Math.max(b.viewport.clientWidth,b.viewport.innerWidth||0),pageBreakpoint:1300,activePages:2,comicActive:0,ballActive:0,enhance:0,lastEnhance:0},d=[{type:"cbr",archive:"rar"}],e={title:"Futurama 01",pageCount:8,currentPage:1,pages:["assets/media/example-comic/1.jpg","assets/media/example-comic/2.jpg","assets/media/example-comic/3.jpg","assets/media/example-comic/4.jpg","assets/media/example-comic/5.jpg","assets/media/example-comic/6.jpg","assets/media/example-comic/7.jpg","assets/media/example-comic/8.jpg"]};c.width<c.pageBreakpoint&&(c.activePages=1),this.loadComic=function(){removeClass(document.body,"splash"),removeClass(b.reader,"hidden"),addClass(b.fileSelect,"hidden"),c.comicActive=1,e.currentPage=1,a.nimbus.loadPage(e.currentPage)},this.loadPage=function(){var d,f;b.reader.innerHTML="",c.activePages<2?(d=new Image,d.src=e.pages[e.currentPage-1],d.style.opacity=0,b.reader.appendChild(d),b.title.innerHTML=e.title+" | "+e.currentPage+"/"+e.pageCount,a.setTimeout(function(){nimbus.animateIn(function(){removeClass(b.reader,"loading")})},200)):(d=new Image,d.src=e.pages[e.currentPage-1],d.style.opacity=0,e.currentPage<e.pageCount&&(f=new Image,f.src=e.pages[e.currentPage],f.style.opacity=0),b.reader.appendChild(d),b.reader.appendChild(f),b.title.innerHTML=e.title+" | "+(e.currentPage+1)+"/"+e.pageCount,a.setTimeout(function(){nimbus.animateIn(function(){removeClass(b.reader,"loading")})},200))},this.animateIn=function(b){var c,d,e=0;for(d=document.querySelectorAll("#reader img"),c=d.length,e;c>e;e++)d[e].style.opacity=1;a.setTimeout(function(){b()},200)},this.animateOut=function(c){var d,e,f=0;for(e=document.querySelectorAll("#reader img"),d=e.length,f;d>f;f++)e[f].style.opacity=0;a.setTimeout(function(){addClass(b.reader,"loading"),c()},200)},this.navigate=function(a){switch(a){case 1:if(!(e.currentPage<e.pageCount))return;if(c.activePages>1){if(!(e.currentPage<e.pageCount-1))return;e.currentPage+=2}else e.currentPage++;nimbus.animateOut(function(){nimbus.loadPage()});break;case 2:if(!(e.currentPage>1))return;if(c.activePages>1){if(!(e.currentPage>2))return;e.currentPage-=2}else e.currentPage--;nimbus.animateOut(function(){nimbus.loadPage()})}},this.checkSize=function(){c.width=Math.max(b.viewport.clientWidth,b.viewport.innerWidth||0),1===c.comicActive&&(c.width>c.pageBreakpoint?(c.activePages=2,e.currentPage>1&&isEven(e.currentPage)&&(e.currentPage-=1)):c.activePages=1,nimbus.loadPage())},this.brightnessOn=function(){addClass(b.brightnessOverlay,"active"),a.setTimeout(function(){b.brightnessOverlay.style.opacity=1},50)},this.brightnessOff=function(){c.ballActive=0,b.brightnessOverlay.style.opacity=0,b.reader.className="reader amplify-"+c.enhance,a.setTimeout(function(){removeClass(b.brightnessOverlay,"active")},200)},this.ballMove=function(a){var d,e,f,g,h;c.ballActive&&(d=a.x,e=b.brightnessContent.offsetLeft,f=b.brightnessContent.offsetWidth,g=e+f,g>d&&d>e&&(d-=e,b.brightnessBall.style.left=d+"px"),h=Math.round(d/f*10),h>10?h=10:0>h&&(h=0),c.enhance=h,c.enhance!==c.lastEnhance&&(b.beautifyLevel.innerHTML="x"+c.enhance,c.lastEnhance=c.enhance))},this.loadFileDialogue=function(){alert("Rquers file")},this.handleFile=function(a){var b;return b=nimbus.checkFormat(a.name),b===!1?void alert("Invalid file format."):void nimbus.extractArchive(a,b)},this.extractArchive=function(a,b){switch(b){case"cbr":}},this.checkFormat=function(a){var b,c,e,f,g;for(b=/(?:\.([^.]+))?$/,c=b.exec(a)[1].toLowerCase(),e=!1,g=d.length,f=0;g>f;f++)if(c===d[f].type){e=!0;break}return e===!0?c:!1},a.onresize=function(){nimbus.checkSize()},swipe.attach("viewport",function(a){0!==c.comicActive&&nimbus.navigate(a)}),a.onkeydown=function(a){var b;if("undefined"!=typeof a.which){switch(a.which){case 39:b=1;break;case 37:b=2}nimbus.navigate(b)}},b.brightness.onclick=function(a){a.preventDefault(),nimbus.brightnessOn()},b.brightnessBall.onmousedown=function(a){a.preventDefault(),a.stopPropagation(),c.ballActive=1,addClass(b.brightnessBall,"inactive")},b.brightnessBall.ontouchstart=function(a){a.preventDefault(),a.stopPropagation(),c.ballActive=1,addClass(b.brightnessBall,"inactive")},b.brightnessContent.onmouseup=function(a){a.preventDefault(),c.ballActive=0,removeClass(b.brightnessBall,"inactive"),nimbus.brightnessOff()},b.brightnessContent.ontouchend=function(a){a.preventDefault(),c.ballActive=0,removeClass(b.brightnessBall,"inactive"),nimbus.brightnessOff()},b.brightnessContent.onclick=function(a){a.preventDefault(),a.stopPropagation()},b.brightnessContent.onmousemove=function(a){a.stopPropagation(),nimbus.ballMove(a)},b.brightnessContent.ontouchmove=function(a){a.stopPropagation(),a.x=a.targetTouches[0].pageX,nimbus.ballMove(a)},b.brightnessOverlay.onclick=function(a){a.preventDefault(),nimbus.brightnessOff()},document.body.addEventListener("dragover",function(){addClass(b.dragDropOverlay,"active"),a.setTimeout(function(){removeClass(b.dragDropOverlay,"active")},5e3)}),document.body.addEventListener("dragend",function(){removeClass(b.dragDropOverlay,"active")}),document.body.addEventListener("drop",function(a){var c;removeClass(b.dragDropOverlay,"active"),"undefined"!=typeof a.dataTransfer.files&&(c=a.dataTransfer.files,c.length>1||nimbus.handleFile(c[0]))}),a.nimbus=this,a.onload=function(){nimbus.checkSize()}}(window);